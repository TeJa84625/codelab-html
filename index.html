<!DOCTYPE html>
<html lang="en" class="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeLab - HTML</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Fira+Code&family=Hack&family=Inconsolata&family=JetBrains+Mono&family=Roboto+Mono&family=Source+Code+Pro&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/material-darker.min.css">


    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        mono: ['"Courier New"', 'Courier', 'monospace'],
                        'fira-code': ['"Fira Code"', 'monospace'],
                        'consolas': ['Consolas', 'monospace'],
                        'monaco': ['Monaco', 'monospace'],
                        'source-code-pro': ['"Source Code Pro"', 'monospace'],
                        'inconsolata': ['Inconsolata', 'monospace'],
                        'hack': ['Hack', 'monospace'],
                        'jetbrains-mono': ['"JetBrains Mono"', 'monospace'],
                        'cascadia-code': ['"Cascadia Code"', 'monospace'],
                        'courier-new': ['"Courier New"', 'Courier', 'monospace'],
                        'roboto-mono': ['"Roboto Mono"', 'monospace'],
                    },
                },
            },
        }
    </script>

    <style>
        body,
        .bg-gray-50,
        .bg-white,
        .bg-gray-100,
        .bg-gray-800,
        .bg-gray-900,
        textarea,
        input,
        button,
        iframe,
        select,
        .dark-mode-transition {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        .file-tabs::-webkit-scrollbar {
            height: 6px;
        }

        .file-tabs::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        .file-tabs::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 3px;
        }

        .dark .file-tabs::-webkit-scrollbar-track {
            background: #1f2937;
        }

        .dark .file-tabs::-webkit-scrollbar-thumb {
            background: #4b5563;
        }

        select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%236B7280%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-13%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2013l128%20128c3.6%203.6%207.8%205.4%2013%205.4s9.4-1.8%2013-5.4l128-128c3.6-3.6%205.4-7.8%205.4-13%200-5-1.8-9.2-5.4-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-position: right 0.75rem center;
            background-repeat: no-repeat;
            background-size: 0.65em auto;
            padding-right: 2.5rem;
        }

        .dark select {
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%239CA3AF%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-13%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2013l128%20128c3.6%203.6%207.8%205.4%2013%205.4s9.4-1.8%2013-5.4l128-128c3.6-3.6%205.4-7.8%205.4-13%200-5-1.8-9.2-5.4-12.8z%22%2F%3E%3C%2Fsvg%3E');
        }

        #code-editor {
            display: none;
        }

        .CodeMirror {
            font-family: '"Courier New"', Courier, monospace;
            height: 100%;
            font-size: 14px;
            line-height: 1.5;
        }

        .CodeMirror-gutters {
            background-color: #f7fafc;
            border-right: 1px solid #e2e8f0;
        }

        .dark .CodeMirror {
            background-color: #030712;
        }

        .dark .CodeMirror-gutters {
            background-color: #1f2937;
            border-right: 1px solid #374151;
        }
    </style>
</head>

<body
    class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 flex flex-col h-screen overflow-hidden font-sans">

    <div id="mobile-warning"
        class="md:hidden flex flex-col items-center justify-center fixed inset-0 bg-black/80 z-[100] p-4 text-center">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl">
            <i class="fas fa-mobile-screen-button text-4xl text-blue-500 mb-4"></i>
            <h2 class="text-xl font-bold mb-2">Best Experience on Desktop</h2>
            <p class="text-gray-700 dark:text-gray-300">
                This CodeLab is designed for larger screens. Please switch to a desktop or tablet for the best
                experience.
            </p>
        </div>
    </div>

    <header
        class="flex-shrink-0 bg-gray-100 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-3 flex items-center justify-between shadow-sm z-10">
        <h1 class="text-xl font-bold text-blue-600 dark:text-blue-400">
            CodeLab - HTML
        </h1>
        <div class="flex items-center space-x-3">

            <button id="about-btn"
                class="flex items-center justify-center w-10 h-10 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition-all duration-200"
                aria-label="Open About Page" onclick="window.location.href='about.html'">
                <i class="fas fa-info-circle"></i>
            </button>

            <button id="settings-btn"
                class="flex items-center justify-center w-10 h-10 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition-all duration-200"
                aria-label="Open settings">
                <i class="fas fa-cog"></i>
            </button>

            <button id="developer-btn"
                class="flex items-center justify-center w-10 h-10 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition-all duration-200"
                aria-label="Open developer features">
                <i class="fas fa-laptop-code"></i>
            </button>

            <button id="download-project-btn"
                class="flex items-center space-x-2 bg-green-600 text-white px-4 py-2 rounded-lg shadow-md hover:bg-green-700 transition-all duration-200">
                <i class="fas fa-download"></i>
                <span>Download Project</span>
            </button>
        </div>
    </header>

    <main class="flex-grow grid grid-cols-1 md:grid-cols-[1fr_auto_1fr] gap-0 overflow-hidden" id="main-container">

        <div class="flex flex-col h-full overflow-hidden bg-gray-50 dark:bg-gray-900" id="left-panel">

            <div
                class="flex-shrink-0 flex items-center justify-between border-b border-gray-200 dark:border-gray-700 bg-gray-100 dark:bg-gray-800 p-2">
                <nav class="file-tabs flex-grow flex items-center space-x-1 overflow-x-auto" id="file-tabs-container">
                </nav>
                <button id="add-file-btn"
                    class="flex-shrink-0 ml-3 px-3 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-all"
                    aria-label="Add new file">
                    <i class="fas fa-plus"></i>
                </button>
            </div>

            <div
                class="flex-shrink-0 flex items-center justify-between p-3 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 shadow-sm">
                <span class="font-mono font-semibold" id="current-file-name">index.html</span>
                <div class="flex items-center space-x-4">
                    <button id="rename-file-btn"
                        class="flex items-center space-x-1.5 text-sm text-gray-600 dark:text-gray-300 hover:text-black dark:hover:text-white"
                        aria-label="Rename file">
                        <i class="fas fa-pencil-alt w-4 h-4"></i>
                        <span>Rename</span>
                    </button>
                    <button id="delete-file-btn"
                        class="flex items-center space-x-1.5 text-sm text-red-500 hover:text-red-700"
                        aria-label="Delete file">
                        <i class="fas fa-trash w-4 h-4"></i>
                        <span>Delete</span>
                    </button>
                </div>
            </div>

            <div class="flex-grow relative min-h-0">
                <textarea id="code-editor"
                    class="w-full h-full p-4 text-sm bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 border-0 focus:ring-0 resize-none outline-none leading-relaxed"
                    spellcheck="false" autocomplete="off" autocorrect="off" autocapitalize="off"></textarea>
            </div>
        </div>

        <div id="resize-gutter"
            class="hidden md:block w-2 bg-gray-200 dark:bg-gray-700 cursor-col-resize hover:bg-blue-500 dark:hover:bg-blue-600 transition-colors duration-200"
            style="touch-action: none;"></div>

        <div class="flex flex-col h-full overflow-hidden bg-gray-100 dark:bg-gray-800" id="right-panel">

            <div
                class="flex-shrink-0 flex items-center space-x-3 p-3 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 shadow-sm">
                <button id="run-code-btn"
                    class="flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-md hover:bg-blue-700 transition-all duration-200">
                    <i class="fas fa-play-circle w-4 h-4"></i>
                    <span>Run</span>
                </button>

                <button id="run-new-tab-btn"
                    class="flex items-center space-x-2 bg-gray-600 text-white px-4 py-2 rounded-lg shadow-md hover:bg-gray-700 transition-all duration-200">
                    <i class="fas fa-window-restore w-4 h-4"></i>
                    <span>Run in New Tab</span>
                </button>

            </div>

            <div class="flex-grow relative bg-white m-2 rounded-lg shadow-inner">
                <div id="new-tab-message-panel"
                    class="w-full h-full flex flex-col items-center justify-center p-4 text-center text-gray-500 dark:text-gray-400 hidden">
                    <i class="fas fa-window-restore text-6xl mb-4"></i>
                    <h3 class="text-xl font-semibold">Preview is Live in New Tab</h3>
                    <p class="mt-2">Your code is running in a separate tab. Click "Run" to preview it here again.</p>
                    
                    <button id="update-new-tab-btn"
                        class="mt-4 px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700">
                        <i class="fas fa-sync-alt mr-2"></i>Update Tab
                    </button>
                </div>

                <iframe id="preview-frame" class="w-full h-full border-0 rounded-lg"
                    sandbox="allow-scripts allow-same-origin allow-forms allow-popups allow-modals"
                    title="Code Preview"></iframe>
            </div>
        </div>
    </main>

    <div id="modal-backdrop" class="fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50 hidden"
        role="dialog" aria-modal="true">

        <div id="add-file-modal"
            class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md hidden dark-mode-transition">
            <h3 class="text-lg font-semibold mb-4">Create New File</h3>
            <div class="mb-4">
                <label for="new-file-name" class="block text-sm font-medium mb-1">File Name (without extension)</label>
                <div class="flex space-x-2">
                    <input type="text" id="new-file-name"
                        class="flex-grow w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700"
                        placeholder="e.g., app or contact">
                    <select id="new-file-extension"
                        class="flex-shrink-0 p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700">
                        <option value=".html">.html</option>
                        <option value=".css">.css</option>
                        <option value=".js">.js</option>
                    </select>
                </div>
            </div>
            <div class="flex justify-end space-x-3">
                <button type="button"
                    class="modal-cancel-btn px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500">
                    <i class="fas fa-times-circle mr-2"></i> Cancel
                </button>
                <button type="button" id="create-file-confirm-btn"
                    class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700">
                    <i class="fas fa-check-circle mr-2"></i> Create
                </button>
            </div>
        </div>

        <div id="rename-file-modal"
            class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md hidden dark-mode-transition">
            <h3 class="text-lg font-semibold mb-4">Rename File</h3>
            <div class="mb-4">
                <label for="rename-file-name" class="block text-sm font-medium mb-1">New File Name (without
                    extension)</label>
                <div class="flex space-x-2">
                    <input type="text" id="rename-file-name"
                        class="flex-grow w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700"
                        placeholder="e.g., new-name">
                    <select id="rename-file-extension"
                        class="flex-shrink-0 p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700">
                        <option value=".html">.html</option>
                        <option value=".css">.css</option>
                        <option value=".js">.js</option>
                    </select>
                </div>
            </div>
            <div class="flex justify-end space-x-3">
                <button type="button"
                    class="modal-cancel-btn px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500">Cancel
                </button>
                <button type="button" id="rename-file-confirm-btn"
                    class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700">Rename</button>
            </div>
        </div>

        <div id="download-project-modal"
            class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md hidden dark-mode-transition">
            <h3 class="text-lg font-semibold mb-4">Download Project</h3>
            <div class="mb-4">
                <label for="project-folder-name" class="block text-sm font-medium mb-1">Project Folder Name</label>
                <input type="text" id="project-folder-name"
                    class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700"
                    value="my-codelab-project">
            </div>
            <div class="flex justify-end space-x-3">
                <button type="button"
                    class="modal-cancel-btn px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500">Cancel</button>
                <button type="button" id="download-project-confirm-btn"
                    class="px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700">Download .zip</button>
            </div>
        </div>

        <div id="confirm-modal"
            class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md hidden dark-mode-transition">
            <h3 class="text-lg font-semibold mb-4" id="confirm-title">Are you sure?</h3>
            <p class="mb-6" id="confirm-message">This action cannot be undone.</p>
            <div class="flex justify-end space-x-3">
                <button type="button" id="confirm-cancel-btn"
                    class="modal-cancel-btn px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500">Cancel</button>
                <button type="button" id="confirm-confirm-btn"
                    class="px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700">Confirm</button>
            </div>
        </div>

        <div id="settings-modal"
            class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md hidden dark-mode-transition">
            <h3 class="text-lg font-semibold mb-6">Settings</h3>

            <div class="mb-4">
                <label for="font-select" class="block text-sm font-medium mb-2">Editor Font</label>
                <select id="font-select"
                    class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700">
                    <option style="font-family: 'Fira Code', monospace;" value="'Fira Code', monospace">Fira Code
                    </option>
                    <option style="font-family: 'JetBrains Mono', monospace;" value="'JetBrains Mono', monospace">
                        JetBrains Mono</option>
                    <option style="font-family: 'Source Code Pro', monospace;" value="'Source Code Pro', monospace">
                        Source Code Pro</option>
                    <option style="font-family: 'Hack', monospace;" value="'Hack', monospace">Hack</option>
                    <option style="font-family: 'Roboto Mono', monospace;" value="'Roboto Mono', monospace">Roboto Mono
                    </option>
                    <option style="font-family: 'Inconsolata', monospace;" value="'Inconsolata', monospace">Inconsolata
                    </option>
                    <option style="font-family: 'Cascadia Code', monospace;" value="'Cascadia Code', monospace">Cascadia
                        Code</option>
                    <option style="font-family: Consolas, monospace;" value="Consolas, monospace">Consolas</option>
                    <option style="font-family: Monaco, monospace;" value="Monaco, monospace">Monaco</option>
                    <option style="font-family: 'Courier New', Courier, monospace;"
                        value="'Courier New', Courier, monospace">Courier New</option>
                </select>
            </div>

            <div class="mb-6">
                <label class="block text-sm font-medium mb-2">Theme</label>
                <div class="flex items-center justify-between p-3 bg-gray-100 dark:bg-gray-700 rounded-lg">
                    <span class="text-gray-700 dark:text-gray-300">Toggle Light / Dark Mode</span>
                    <button id="theme-toggle-btn"
                        class="p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 dark-mode-transition"
                        aria-label="Toggle dark mode">
                        <i class="fas fa-moon" id="theme-icon-moon"></i>
                        <i class="fas fa-sun hidden" id="theme-icon-sun"></i>
                    </button>
                </div>
            </div>

            <div class="flex justify-end space-x-3">
                <button type="button"
                    class="modal-cancel-btn px-5 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700">
                    Close
                </button>
            </div>
        </div>

        <div id="developer-modal"
            class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md hidden dark-mode-transition">
            <h3 class="text-lg font-semibold mb-6">Developer Features</h3>

            <div class="mb-6">
                <label for="bulk-file-names-input" class="block text-sm font-medium mb-2">Bulk Create Files</label>
                <input type="text" id="bulk-file-names-input"
                    class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700"
                    placeholder="e.g., about.html, contact.html, app.js">
                <button id="bulk-create-btn"
                    class="mt-2 w-full px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700">
                    Create Files
                </button>
            </div>

            <div class="mb-6">
                <label class="block text-sm font-medium mb-2">Import File</label>
                <button id="import-file-btn"
                    class="w-full px-4 py-2 rounded-lg bg-gray-600 text-white hover:bg-gray-700">
                    <i class="fas fa-upload mr-2"></i> Click to Import
                </button>
                <input type="file" id="import-file-input" class="hidden" accept=".html,.css,.js">
                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Accepts .html, .css, or .js files.</p>
            </div>

            <div class="flex justify-end space-x-3">
                <button type="button"
                    class="modal-cancel-btn px-5 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500">
                    Close
                </button>
            </div>
        </div>

        <div id="import-rename-modal"
            class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md hidden dark-mode-transition">
            <h3 class="text-lg font-semibold mb-4">File Name Conflict</h3>
            <p id="import-conflict-message" class="text-sm mb-4">A file with this name already exists. Please provide a
                new name.</p>
            <div class="mb-4">
                <label for="import-rename-name" class="block text-sm font-medium mb-1">New File Name</label>
                <div class="flex space-x-2">
                    <input type="text" id="import-rename-name"
                        class="flex-grow w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700"
                        placeholder="e.g., new-file-name">
                    <select id="import-rename-extension"
                        class="flex-shrink-0 p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700">
                        <option value=".html">.html</option>
                        <option value=".css">.css</option>
                        <option value=".js">.js</option>
                    </select>
                </div>
            </div>
            <div class="flex justify-end space-x-3">
                <button type="button"
                    class="modal-cancel-btn px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500">Cancel
                </button>
                <button type="button" id="import-rename-confirm-btn"
                    class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700">Confirm & Import</button>
            </div>
        </div>


    </div>

</body>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/css/css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/htmlmixed/htmlmixed.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/edit/closetag.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/edit/closebrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/comment/comment.min.js"></script>

    <script src="script.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof startApp === 'function') {
                startApp();
            } else {
                console.error("Failed to find startApp function. script.js might be broken.");
            }
        });
    </script>

</html>